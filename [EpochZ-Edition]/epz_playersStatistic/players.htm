
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/highcharts.js"></script>
<script src="js/highcharts-more.js"></script>
<script src="js/exporting.js"></script>

<div id="container2" style="width:100%;height:100%"></div>
<br/>
<br/>
<div id="container3" style="width:100%;height:100%"></div>


<script>
var chart2 = Highcharts.chart('container2', {
    chart: {
        type: 'area'
    },
    title: {
        text: 'Estatísticas do jogador'
    },
    subtitle: {
        text: 'Cada conexão / login de conta é contado'
    },
    xAxis: {
         categories: []
    },
    yAxis: {
        title: {
            text: 'Número de conexões'
        },
        labels: {
            formatter: function () {
                return this.value;
            }
        }
    },
    tooltip: {
        pointFormat: '{series.name} <b>{point.y:,.0f}</b><br/>'
    }, 
	plotOptions: {
        area: {
            marker: {
                enabled: false,
                symbol: 'circle',
                radius: 1,
                states: {
                    hover: {
                        enabled: true
                    }
                }
            }
        }
    },

    series: [{
        name: 'Total de conexões',
        data: []
    }, {
        name: 'Conexões de novos jogadores',
        data: []
    },{
        name: 'Jogadores únicos',
        data: []
    }]
});
</script>

<script>
var chart3 = Highcharts.chart('container3', {
    chart: {
        type: 'line'
    },
    title: {
        text: 'Tempo de jogo de jogadores únicos'
    },
    xAxis: {
         categories: []
    },
    yAxis: {
        title: {
            text: 'Tempo de jogo em minutos'
        },
        labels: {
            formatter: function () {
                return this.value;
            }
        }
    },
    tooltip: {
        pointFormat: '{series.name} <b>{point.y:,.0f}</b><br/>'
    }, 
	plotOptions: {
        area: {
            marker: {
                enabled: false,
                symbol: 'circle',
                radius: 1,
                states: {
                    hover: {
                        enabled: true
                    }
                }
            }
        }
    },

    series: [{
        name: 'Tempo total de jogo',
        data: []
    }, {
        name: 'Tempo médio de jogo',
        data: []
    },{
        name: 'Jogadores únicos',
        data: []
    }]
});
</script>
<script>

<*



local playersStatistic = executeSQLQuery("SELECT * FROM `playersStatistic` " )

httpWrite("var playersStatisticDate = [")
for i,stat in pairs(playersStatistic) do 	
	httpWrite("'"..stat.date.."',")
end
httpWrite("];\r\n")	

	
httpWrite("var playersStatisticConnects = [")
for i,stat in pairs(playersStatistic) do 	
	httpWrite(""..stat.connects..",")
end
httpWrite("];\r\n")		

httpWrite("var playersStatisticNewPlayers = [")
for i,stat in pairs(playersStatistic) do 	
	httpWrite(""..stat.newPlayers..",")
end
httpWrite("];\r\n")	

httpWrite("var playersStatisticUniquePlayers = [")
for i,stat in pairs(playersStatistic) do 	
	httpWrite(""..stat.uniquePlayers..",")
end
httpWrite("];\r\n")


httpWrite("var playersStatisticUniquePlayersTimeAverage = [")
for i,stat in pairs(playersStatistic) do 
local mins  = (stat.uniquePlayersTime/stat.uniquePlayers)
httpWrite(""..mins..",")
end
httpWrite("];\r\n")	

httpWrite("var playersStatisticUniquePlayersTimeAll = [")
for i,stat in pairs(playersStatistic) do 
httpWrite(""..stat.uniquePlayersTime..",")
end
httpWrite("];\r\n")

*>

chart2.update({xAxis: {categories: playersStatisticDate}});
chart2.update({series: [{data: playersStatisticConnects},{data:playersStatisticNewPlayers},{data:playersStatisticUniquePlayers}]});	

chart3.update({xAxis: {categories: playersStatisticDate}});
chart3.update({series: [{data: playersStatisticUniquePlayersTimeAll},{data:playersStatisticUniquePlayersTimeAverage},{data:playersStatisticUniquePlayers}]});	

</script>